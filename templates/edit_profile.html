{% extends 'base.html' %}

{% block title %}Edit profile Page{% endblock %}


{% block nav %}

<form class = "d-flex" role = "search">
    <div class = "dropdown ms-auto">
        <button class = "btn btn-outline-primary dropdown-toggle" type = "button" data-bs-toggle = "dropdown"
            aria-expanded = "false">
            {{ user.name }}
        </button>
        <ul class = "dropdown-menu dropdown-menu-end p-3 shadow" style = "min-width: 250px;">
            <li><strong>Name:</strong> {{ user.name }}</li>
            <li><strong>Email:</strong>{{ user.email }}</li>

            <li class = "mt-3 d-flex justify-content-between px-3">
                <a href = "{{ url_for( 'main_routes.EditProfile' ) }}" class = "btn btn-sm btn-warning">Edit</a>
                <a href = "{{ url_for( 'main_routes.ViewProfile' ) }}" class = "btn btn-sm btn-info text-white">View</a>
            </li>
            <li>
                <hr class = "dropdown-divider">
            </li>
            <li><a class = "dropdown-item text-danger" href = "{{ url_for( 'main_routes.Logout' ) }}">Logout</a></li>
        </ul>
    </div>
</form>
{% endblock %}


{% block body %}


{% with messages = get_flashed_messages( with_categories = true ) %}
{% if messages %}
{% for category , message in messages %}
<div class = "alert alert-danger alert-dismissible fade show d-flex align-items-center mb-0 rounded-3 shadow-sm" role = "alert">
    <span style = "font-size: 1.5rem; margin-right: 0.5rem;">⚠️</span>
    <div>
        {{ message }}
    </div>
    <button type = "button" class = "btn-close" data-bs-dismiss = "alert" aria-label = "Close"></button>
</div>
{% endfor %}
{% endif %}
{% endwith %}

<div class = "container d-flex justify-content-center align-items-center min-vh-100 py-5">
    <div class = "col-12 col-md-8 col-lg-7">
        <div class = "card shadow-lg rounded-3 border border-light">
            <div class = "card-header bg-warning text-white text-center py-3 rounded-top-3">
                <h2 class = "mb-0 fw-bold">Edit Your Profile</h2>
                <p class = "mb-0 text-white-50">Update your personal details and password.</p>
            </div>
            <div class = "card-body p-4">
                <form method = "POST" action = "{{ url_for( 'main_routes.EditProfile' ) }}">
                    <div class = "mb-3">
                        <label for = "name" class = "form-label fw-semibold text-dark">Name</label>
                        <input type = "text" class = "form-control rounded-3" name = "name" value = "{{ user.name }}" required>
                    </div>

                    <div class = "mb-3">
                        <label for = "email" class = "form-label fw-semibold text-dark">Email</label>
                        <input type = "email" class = "form-control rounded-3" name = "email" value = "{{ user.email }}" required>
                    </div>

                    <div class = "mb-3">
                        <label for = "phone" class = "form-label fw-semibold text-dark">Phone</label>
                        <input type = "text" class = "form-control rounded-3" name = "phone" value = "{{ user.phone }}" required>
                    </div>

                    <div class = "mb-3 input-group">
                        <span class = "input-group-text rounded-start fw-semibold text-dark" id = "address-addon">Address</span>
                        <textarea class = "form-control rounded-end" name = "address" rows = "2" aria-describedby = "address-addon">{{ user.address }}</textarea>
                    </div>


                    <div class = "mb-3">
                        <label for = "gender" class = "form-label fw-semibold text-dark">Gender</label>
                        <select class = "form-select rounded-3" name = "gender">
                            <option value = "Male" {% if user.gender  == 'Male' %}selected{% endif %}>Male</option>
                            <option value = "Female" {% if user.gender  == 'Female' %}selected{% endif %}>Female</option>
                            <option value = "Other" {% if user.gender  == 'Other' %}selected{% endif %}>Other</option>
                        </select>
                    </div>

                    <div class = "mb-3">
                        <label for = "dob" class = "form-label fw-semibold text-dark">Date of Birth</label>
                        <input type = "date" class = "form-control rounded-3" name = "DOB" value = "{{ user.DOB }}">
                    </div>

                    <div class = "mb-3">
                        <label for = "vehicle_number" class = "form-label fw-semibold text-dark">Vehicle Number</label>
                        <input type = "text" class = "form-control rounded-3" name = "vehicle_number" value = "{{ user.vechile_number }}">
                    </div>

                    <div class = "mb-3">
                        <label for = "new_password" class = "form-label fw-semibold text-dark">Enter new password ( if you want to change )</label>
                        <input type = "password" class = "form-control rounded-3" name = "new_password">
                    </div>

                    <div class = "mb-3">
                        <label for = "conform_password" class = "form-label fw-semibold text-dark">Confirm new password ( if you want to change )</label>
                        <input type = "password" class = "form-control rounded-3" name = "conform_password">
                    </div>

                    <div class = "mb-4">
                        <label for = "password" class = "form-label fw-semibold text-dark">Enter old password ( required to save changes )</label>
                        <input type = "password" class = "form-control rounded-3" name = "password" required>
                    </div>

                    <div class = "d-flex justify-content-center gap-3">
                        <button type = "submit" class = "btn btn-success btn-lg rounded-pill shadow-sm">
                            <i class = "bi bi-save me-2"></i> Save Changes
                        </button>
                        <a href = "{{ url_for( 'main_routes.HomePage' ) }}" class = "btn btn-outline-secondary btn-lg rounded-pill shadow-sm">
                            <i class = "bi bi-x-circle me-2"></i> Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}